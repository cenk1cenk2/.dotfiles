#!/usr/bin/env sh

# Wayland session configuration
export XDG_SESSION_TYPE=wayland
export XDG_CURRENT_DESKTOP=sway

# libseat backend
export LIBSEAT_BACKEND=logind

# WLR configuration
export WLR_RENDERER_ALLOW_SOFTWARE=1
export WLR_XWAYLAND=/usr/local/bin/Xwayland

# Qt configuration
export QT_QPA_PLATFORM=wayland
export QT_QPA_PLATFORMTHEME=gtk2
export QT_WAYLAND_DISABLE_WINDOWDECORATION=1

# GTK configuration
export GTK_USE_PORTAL=1
export GDK_BACKEND=wayland
export GDK_DEBUG=portals

# Gaming optimizations
export DXVK_ASYNC=1
export MANGOHUD=1

# Docker configuration
export DOCKER_BUILDKIT=1

# Firefox Wayland support
export MOZ_ENABLE_WAYLAND=1
export MOZ_DBUS_REMOTE=1

# NVIDIA-specific configuration
export GBM_BACKEND=nvidia-drm
export __NV_PRIME_RENDER_OFFLOAD=1
export __GLX_VENDOR_LIBRARY_NAME=nvidia
export VDPAU_DRIVER=nvidia
export LIBVA_DRIVER_NAME=nvidia
export WEBKIT_DISABLE_COMPOSITING_MODE=1
export PROTON_HIDE_NVIDIA_GPU=0
export PROTON_ENABLE_NVAPI=1
export DXVK_ENABLE_NVAPI=1
export PROTON_ENABLE_NGX_UPDATER=1
export VKD3D_CONFIG=dxr,dxr11
export VKD3D_FEATURE_LEVEL=12_2

exec sway --unsupported-gpu 2>&1 | tee /tmp/sway.log
